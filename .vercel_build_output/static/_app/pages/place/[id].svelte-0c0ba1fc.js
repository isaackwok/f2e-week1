import{J as d,S as P,i as y,s as b,j as _,m as h,o as D,x as C,u as S,v as U}from"../../chunks/vendor-9f24c8b6.js";import{D as $}from"../../chunks/DetailPage-8c6bb976.js";import"../../chunks/ImageCardContainer-30b3de4f.js";function j(n){let t,r;return t=new $({props:{item:n[0],category:g,categoryZh:u,more:n[1],moreHeader:"\u9084\u6709\u9019\u4E9B\u4E0D\u80FD\u932F\u904E\u7684"+u,moreText:"\u67E5\u770B\u66F4\u591A"+n[2]+u}}),{c(){_(t.$$.fragment)},l(e){h(t.$$.fragment,e)},m(e,s){D(t,e,s),r=!0},p(e,[s]){const i={};s&1&&(i.item=e[0]),s&2&&(i.more=e[1]),s&4&&(i.moreText="\u67E5\u770B\u66F4\u591A"+e[2]+u),t.$set(i)},i(e){r||(C(t.$$.fragment,e),r=!0)},o(e){S(t.$$.fragment,e),r=!1},d(e){U(t,e)}}}async function x({page:n}){var i,a;const t=n.params.id,r=await d.get("/ScenicSpot",{params:{$filter:`ID eq '${t}'`}}),e=r.data.pop(),s=await d.get("/ScenicSpot",{params:{$top:4,$filter:`ID ne '${t}' and Picture/PictureUrl1 ne null`,$spatialFilter:`nearby(${(i=e.Position)==null?void 0:i.PositionLat}, ${(a=e.Position)==null?void 0:a.PositionLon}, 10000)`}}).then(l=>l.data);return r.status===200?{props:{place:e,nearby:s}}:{status:r.status,error:new Error(`Could not load ${t}`)}}const g="place",u="\u666F\u9EDE";function w(n,t,r){let e,s,i,{place:a}=t,{nearby:l=[]}=t;return n.$$set=c=>{"place"in c&&r(3,a=c.place),"nearby"in c&&r(4,l=c.nearby)},n.$$.update=()=>{var c,m,p;n.$$.dirty&8&&r(2,e=a.Address.slice(0,3)),n.$$.dirty&8&&r(0,s={images:[{src:(c=a.Picture)==null?void 0:c.PictureUrl1},{src:(m=a.Picture)==null?void 0:m.PictureUrl2},{src:(p=a.Picture)==null?void 0:p.PictureUrl3}].filter(o=>!!o.src),title:a.Name,tags:[a.Class1,a.Class2,a.Class3].filter(o=>!!o),description:a.Description}),n.$$.dirty&16&&r(1,i=l.map(o=>{var f;return{href:`/${g}/${o.ID}`,src:((f=o.Picture)==null?void 0:f.PictureUrl1)||null,title:o.Name,location:o.Address.slice(0,3)}}))},[s,i,e,a,l]}class A extends P{constructor(t){super();y(this,t,w,j,b,{place:3,nearby:4})}}export{A as default,x as load};
