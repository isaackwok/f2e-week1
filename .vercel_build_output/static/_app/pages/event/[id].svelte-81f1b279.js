import{J as p,S as P,i as y,s as _,j as h,m as D,o as b,x as v,u as C,v as U}from"../../chunks/vendor-9f24c8b6.js";import{D as $}from"../../chunks/DetailPage-4d19cf97.js";import"../../chunks/ImageCardContainer-d46f786c.js";function j(a){let e,r;return e=new $({props:{item:a[0],category:g,categoryZh:l,more:a[1],moreHeader:"\u9084\u6709\u9019\u4E9B\u4E0D\u80FD\u932F\u904E\u7684"+l,moreText:"\u67E5\u770B\u66F4\u591A"+a[2]+l}}),{c(){h(e.$$.fragment)},l(t){D(e.$$.fragment,t)},m(t,i){b(e,t,i),r=!0},p(t,[i]){const s={};i&1&&(s.item=t[0]),i&2&&(s.more=t[1]),i&4&&(s.moreText="\u67E5\u770B\u66F4\u591A"+t[2]+l),e.$set(s)},i(t){r||(v(e.$$.fragment,t),r=!0)},o(t){C(e.$$.fragment,t),r=!1},d(t){U(e,t)}}}async function q({page:a}){var s,n;const e=a.params.id,r=await p.get("/Activity",{params:{$filter:`ID eq '${e}'`}}),t=r.data.pop(),i=await p.get("/Activity",{params:{$top:4,$filter:`ID ne '${e}' and Picture/PictureUrl1 ne null`,$spatialFilter:`nearby(${(s=t.Position)==null?void 0:s.PositionLat}, ${(n=t.Position)==null?void 0:n.PositionLon}, 10000)`}}).then(u=>u.data);return r.status===200?{props:{event:t,nearby:i}}:{status:r.status,error:new Error(`Could not load ${e}`)}}const g="event",l="\u6D3B\u52D5";function w(a,e,r){let t,i,s,{event:n}=e,{nearby:u=[]}=e;return a.$$set=c=>{"event"in c&&r(3,n=c.event),"nearby"in c&&r(4,u=c.nearby)},a.$$.update=()=>{var c,m,f;a.$$.dirty&8&&r(2,t=n.Address.slice(0,3)),a.$$.dirty&8&&r(0,i={images:[{src:(c=n.Picture)==null?void 0:c.PictureUrl1},{src:(m=n.Picture)==null?void 0:m.PictureUrl2},{src:(f=n.Picture)==null?void 0:f.PictureUrl3}].filter(o=>!!o.src),title:n.Name,tags:[n.Class1,n.Class2,n.Class3].filter(o=>!!o),description:n.Description}),a.$$.dirty&16&&r(1,s=u.map(o=>{var d;return{href:`/${g}/${o.ID}`,src:((d=o.Picture)==null?void 0:d.PictureUrl1)||null,title:o.Name,location:o.Address.slice(0,3)}}))},[i,s,t,n,u]}class x extends P{constructor(e){super();y(this,e,w,j,_,{event:3,nearby:4})}}export{x as default,q as load};
