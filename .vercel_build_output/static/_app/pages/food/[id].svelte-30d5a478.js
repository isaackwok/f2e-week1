import{J as p,S as P,i as y,s as b,j as _,m as h,o as D,x as U,u as $,v as C}from"../../chunks/vendor-9f24c8b6.js";import{D as j}from"../../chunks/DetailPage-8c6bb976.js";import"../../chunks/ImageCardContainer-30b3de4f.js";function w(a){let e,r;return e=new j({props:{item:a[0],category:g,categoryZh:l,more:a[1],moreHeader:"\u9084\u6709\u9019\u4E9B\u4E0D\u80FD\u932F\u904E\u7684"+l,moreText:"\u67E5\u770B\u66F4\u591A"+a[2]+l}}),{c(){_(e.$$.fragment)},l(t){h(e.$$.fragment,t)},m(t,s){D(e,t,s),r=!0},p(t,[s]){const i={};s&1&&(i.item=t[0]),s&2&&(i.more=t[1]),s&4&&(i.moreText="\u67E5\u770B\u66F4\u591A"+t[2]+l),e.$set(i)},i(t){r||(U(e.$$.fragment,t),r=!0)},o(t){$(e.$$.fragment,t),r=!1},d(t){C(e,t)}}}async function A({page:a}){var i,n;const e=a.params.id,r=await p.get("/Restaurant",{params:{$filter:`ID eq '${e}'`}}),t=r.data.pop(),s=await p.get("/Restaurant",{params:{$top:4,$filter:`ID ne '${e}' and Picture/PictureUrl1 ne null`,$spatialFilter:`nearby(${(i=t.Position)==null?void 0:i.PositionLat}, ${(n=t.Position)==null?void 0:n.PositionLon}, 10000)`}}).then(u=>u.data);return r.status===200?{props:{restaurant:t,nearby:s}}:{status:r.status,error:new Error(`Could not load ${e}`)}}const g="food",l="\u7F8E\u98DF";function I(a,e,r){let t,s,i,{restaurant:n}=e,{nearby:u=[]}=e;return a.$$set=o=>{"restaurant"in o&&r(3,n=o.restaurant),"nearby"in o&&r(4,u=o.nearby)},a.$$.update=()=>{var o,m,f;a.$$.dirty&8&&r(2,t=n.Address.slice(0,3)),a.$$.dirty&8&&r(0,s={images:[{src:(o=n.Picture)==null?void 0:o.PictureUrl1},{src:(m=n.Picture)==null?void 0:m.PictureUrl2},{src:(f=n.Picture)==null?void 0:f.PictureUrl3}].filter(c=>!!c.src),title:n.Name,tags:[n.Class],description:n.Description}),a.$$.dirty&16&&r(1,i=u.map(c=>{var d;return{href:`/${g}/${c.ID}`,src:((d=c.Picture)==null?void 0:d.PictureUrl1)||null,title:c.Name,location:c.Address.slice(0,3)}}))},[s,i,t,n,u]}class L extends P{constructor(e){super();y(this,e,I,w,b,{restaurant:3,nearby:4})}}export{L as default,A as load};
